# Explain each node
## teleop_control_node 
นี้เป็นส่วนหนึ่งของโปรเจคที่ใช้ ROS 2 สำหรับการควบคุมการเคลื่อนที่และการโต้ตอบผ่านแป้นพิมพ์ในสภาพแวดล้อมจำลองด้วย turtlesim และเพิ่มฟังก์ชันการทำงานเฉพาะ เช่น การสร้างพิซซ่าที่ตำแหน่งต่างๆ และการบันทึกตำแหน่งพิซซ่าเหล่านั้นลงในไฟล์ YAML สคริปต์มีการนำเข้าหลายๆ ไลบรารีที่เกี่ยวข้องกับ ROS และการจัดการไฟล์ ตลอดจนการจัดการกับการกดแป้นพิมพ์ผ่านไลบรารี pynput โค้ดนี้แบ่งออกเป็นหลายส่วนที่สำคัญ:

 1. การกำหนดค่าเริ่มต้นและพารามิเตอร์: กำหนดพารามิเตอร์ต่างๆ เช่น จำกัดจำนวนพิซซ่าที่สามารถสร้างได้ และตำแหน่งของพิซซ่าที่ถูกสร้างไว้

 2. การฟังก์ชันควบคุมผ่านแป้นพิมพ์: โดยใช้เทคนิคการตรวจจับการกดแป้นพิมพ์ เพื่อควบคุมการเคลื่อนที่ของ turtlesim สร้างพิซซ่า และบันทึกตำแหน่งพิซซ่า

 3. การบันทึกและโหลดตำแหน่งพิซซ่า: ใช้ไฟล์ YAML ในการบันทึกและโหลดตำแหน่งของพิซซ่าที่ถูกสร้าง โดยมีการตรวจสอบจำนวนครั้งที่บันทึกไว้เพื่อไม่ให้เกินจำนวนที่กำหนด

 4. การเคลื่อนที่อัตโนมัติไปยังพิซซ่า: ฟังก์ชันที่ช่วยให้ turtlesim เคลื่อนที่ไปยังพิซซ่าที่ยังไม่ได้ถูกบันทึกตำแหน่งและ "กิน" พิซซ่านั้น ซึ่งหมายถึงการลบตำแหน่งพิซซ่านั้นออกจากการติดตาม

5. การแสดงการผูกคีย์บนแป้นพิมพ์: สคริปต์แสดงรายการคีย์บนแป้นพิมพ์และการกระทำที่เกี่ยวข้องเมื่อสคริปต์เริ่มทำงาน ช่วยให้ผู้ใช้ทราบว่าแต่ละปุ่มทำหน้าที่อะไร	

## controller_node
การควบคุมการเคลื่อนที่และการปฏิสัมพันธ์ของเต่าในการจำลองแบบเรียลไทม์ผ่านโปรแกรม turtlesim:
โครงสร้างของโปรแกรม

 1. การกำหนดคลาส controller: คลาสนี้สืบทอดจาก Node และมีหน้าที่ควบคุมการเคลื่อนที่และการสร้างพิซซ่าตามตำแหน่งที่กำหนด.

 2. การตั้งค่าเริ่มต้น: ในเมธอด __init__ มีการสร้าง Publisher สำหรับคำสั่งการเคลื่อนที่, การสมัครรับข้อมูลท่าทาง, และการสร้างพิซซ่า รวมทั้งการตั้งค่าคิวสำหรับเป้าหมายและการเคลื่อนที่อัตโนมัติ.

 3. การตอบสนองต่อข้อมูลท่าทาง: เมื่อได้รับข้อมูลท่าทางจาก turtlesim, โปรแกรมจะอัปเดตตำแหน่งปัจจุบันของเต่า.

 4. การจัดการเป้าหมาย: เมื่อมีการรับข้อมูลเป้าหมายใหม่, มันจะถูกเพิ่มเข้าไปในคิวและเริ่มการเคลื่อนที่อัตโนมัติถ้ามันไม่ได้ถูกเปิดใช้งานอยู่.

 5. การคำนวณการเคลื่อนที่: ในทุกๆ ครั้งที่มีการตั้งเวลา, โปรแกรมจะตรวจสอบว่าเป้าหมายถัดไปได้ถึงเกณฑ์ที่กำหนดหรือยัง และควบคุมการเคลื่อนที่ของเต่าเพื่อให้มุ่งหน้าไปยังเป้าหมายนั้น.

 6. การสร้างพิซซ่า: เมื่อเต่าถึงเป้าหมายที่กำหนด, โปรแกรมจะสั่งให้สร้างพิซซ่าที่ตำแหน่งนั้น.

## copy_schedule_node
ภาพรวมของโปรแกรม

โปรแกรมนี้เป็นโหนด ROS ที่ชื่อว่า CopySchedule ซึ่งมีหน้าที่โหลดตำแหน่งที่บันทึกไว้ในไฟล์ YAML และส่งตำแหน่งเหล่านั้นผ่านทางเครือข่าย ROS โดยใช้ topic /target นอกจากนี้ยังมีฟังก์ชันในการเรียกใช้บริการใน ROS เพื่อสร้างเต่าใหม่ในสภาพแวดล้อมจำลอง turtlesim หากต้องการ
รายละเอียดโค้ด

 1. นำเข้าไลบรารีที่จำเป็น: โปรแกรมนำเข้า rclpy สำหรับการทำงานกับ ROS และ yaml สำหรับการจัดการไฟล์ YAML รวมถึง os สำหรับการจัดการไฟล์และเส้นทางในระบบไฟล์

 2. การสร้างและกำหนดค่าโหนด: ภายในเมธอด __init__, มีการสร้างพับลิชเชอร์สำหรับส่งข้อมูลไปยัง topic /target ที่ใช้สำหรับส่งตำแหน่งที่ต้องการ

 3. การโหลดและประมวลผลไฟล์ YAML: ฟังก์ชัน load_and_publish_positions จะโหลดไฟล์ YAML ที่เก็บตำแหน่งที่บันทึกไว้และส่งตำแหน่งเหล่านั้นผ่านทางพับลิชเชอร์ไปยัง topic /target โดยมีการตรวจสอบว่าตำแหน่งที่ส่งตรงกับ save_count ที่กำหนด

 4. การสร้างเต่าใหม่: เมธอด spawn_turtle ใช้เพื่อเรียกบริการใน ROS เพื่อสร้างเต่าใหม่ในตำแหน่งที่กำหนด ซึ่งโปรแกรมจะตรวจสอบว่าบริการพร้อมใช้งานและส่งคำขอสร้างเต่า
 
# วิธีการรัน
(ทำ launch file ไม่สำเร็จ ทำให้รันได้แค่ข้อ 1 ทั้งหมด กับ ข้อ 2 ทีเกี่ยวกับการเดินตามตำแหน่งที่เก็บอยู่ใน yaml)

### การรันต้องไม่มีไฟล์ pizza_positions.yaml ถูกสร้างไว้ก่อน ทุกครั้งที่จะเริ่ม run ใหม่จำเป็นต้องมาลบ ไฟล์ pizza_positions.yaml ทุกครั้ง (แนะนำไฟล์ .yaml ควรอยู่ directory home)

1. Run Turtlesim_plus_node
```sh
ros2 run turtlesim_plus turtlesim_plus_node.py 
```
2. Run teleop_control_node 
```sh
ros2 run hw_turtle_plus teleop_control.py 
```
3. Run controller_node
```sh
ros2 run copy_turtle controller.py 
```
4. Run cpp_schedule (รัน cmd นี้ทุกครั้งเมื่อต้องการอ่านข้อมูลในไฟล์ pizza_position.yaml)
```sh
ros2 run copy_turtle copy_schedule.py 
```